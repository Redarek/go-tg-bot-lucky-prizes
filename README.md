# üé∞ Lucky-Prizes Telegram Bot

–¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç ‚ÄúLucky-Prizes‚Äù ‚Äî —ç—Ç–æ –º–∏–Ω–∏-–ª–æ—Ç–µ—Ä–µ—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —É–¥–æ–±–Ω–æ–π
–∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å—é –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞.  
–ë–æ—Ç —Ä–∞–∑—ã–≥—Ä—ã–≤–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π —Å—Ç–∏–∫–µ—Ä–ø–∞–∫ **–æ–¥–∏–Ω —Ä–∞–∑ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**,
–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–±–æ—Ä—ã –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ –ø–æ–∫—É–ø–∫–∏ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–Ω–µ–º —Å–∞–π—Ç–µ.

| –°—Ç–µ–∫                    | –ß—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
|-------------------------|------------------|
| **Go 1.24**             | –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞ |
| **pgx / PostgreSQL 15** | —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞–∫–æ–≤ –∏ –ø–æ–ø—ã—Ç–æ–∫ |
| **Docker Compose**      | –ª–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –∏ –ø—Ä–æ–¥ |
| **GitHub Actions** | CI / CD, –º–∏–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `migrate` |

---

## üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç—ã

| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä |
|--------------|---------------|
| ![user](docs/img/user.png) | ![admin](docs/img/admin.png) |

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
* `/start` ‚Äî –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –∫–Ω–æ–ø–∫–∞ **¬´üé≤ –†–∞–∑—ã–≥—Ä–∞—Ç—å¬ª**
* –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –∫–∞–Ω–∞–ª `@your_channel`
* –ù–∞—Ç–∏–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è üé∞ *slot-machine*
* –û–¥–Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –Ω–∞–≤—Å–µ–≥–¥–∞
* C—Å—ã–ª–∫–∞ **¬´–ü–æ–ª—É—á–∏—Ç—å –µ—â—ë¬ª** –≤–µ–¥—ë—Ç –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–π —Å–∞–π—Ç

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
* `/packs` ‚Äî —Å–ø–∏—Å–æ–∫ –ø–∞–∫–æ–≤ –≤ –≤–∏–¥–µ –∫–Ω–æ–ø–æ–∫  
 ‚ÄÉ`[1] Cats`, `[2] DoomGuy ‚Ä¶`
* **‚ûï –î–æ–±–∞–≤–∏—Ç—å** ‚Äî –¥–∏–∞–ª–æ–≥: –Ω–∞–∑–≤–∞–Ω–∏–µ ‚Üí —Å—Å—ã–ª–∫–∞
* **‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å** / **üóëÔ∏è –£–¥–∞–ª–∏—Ç—å**
* –ö–æ–º–∞–Ω–¥—ã –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª—å—Ü—É `ADMIN_ID`
* –í—Å—è —Ä–∞–±–æ—Ç–∞ –≤ –±–æ—Ç–µ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫–∏ –∏ –∫–æ–º–∞–Ω–¥—ã

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

cmd/main.go ‚Äì —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
pkg/
‚îú config/ ‚Äì –∑–∞–≥—Ä—É–∑–∫–∞ .env
‚îú db/ ‚Äì –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ pgx-pool
‚îú models/ ‚Äì —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
‚îú repositories/ ‚Äì —á–∏—Å—Ç—ã–π SQL‚ÄÉCRUD + admin_states
‚îú services/ ‚Äì –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ (–æ–¥–Ω–∞ –ø–æ–ø—ã—Ç–∫–∞, random)
‚îî handlers/ ‚Äì Telegram-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
migrations/ ‚Äì SQL-–º–∏–≥—Ä–∞—Ü–∏–∏ (golang-migrate)
Dockerfile ‚Äì multi-stage build
docker-compose.yml ‚Äì bot + db
.github/workflows/ ‚Äì CI / CD

---

## ‚öôÔ∏è –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
cp .env.example .env

docker-compose up --build -d

docker run --rm -v $(pwd)/migrations:/migrations \
  --network host migrate/migrate \
  -path=/migrations \
  -database "postgres://postgres:postgres@localhost:5432/stickers?sslmode=disable" up
```

–í –ª–æ–≥–∞—Ö (docker-compose logs -f bot) –ø–æ—è–≤–∏—Ç—Å—è:

```bash
Authorized as @LuckyPrizesBot
Bot started.
```

## üì¶ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è          | –ü—Ä–∏–º–µ—Ä                     | –û–ø–∏—Å–∞–Ω–∏–µ                          |
| ------------------- | -------------------------- | --------------------------------- |
| `TELEGRAM_APITOKEN` | `123:ABC`                  | —Ç–æ–∫–µ–Ω –±–æ—Ç–∞                        |
| `ADMIN_ID`          | `1130426011`               | numeric ID –≤–ª–∞–¥–µ–ª—å—Ü–∞              |
| `SHOP_URL`          | `https://shop.example.com` | —Å—Å—ã–ª–∫–∞ ¬´–ø–æ–ª—É—á–∏—Ç—å –µ—â—ë¬ª             |
| `SUB_CHANNEL`       | `-1001234567890`           | –∫–∞–Ω–∞–ª, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–¥–æ –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è |
| `POSTGRES_*`        | ‚Ä¶                          | –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–î           |

## üß™ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
migrate create -ext sql -seq add_some_index
# –ø–æ—è–≤—è—Ç—Å—è 00000X_add_some_index.up/down.sql
vim migrations/00000X_add_some_index.up.sql   # –≤–∞—à–∏ ALTER‚Ä¶
```

